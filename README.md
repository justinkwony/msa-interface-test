# msa-interface-test
Micro Service Architecture에서 App간 인터페이스(Rest vs gRPC) 간 속도 비교 테스트

## 테스트 앱 구성
앱간 내부 통신 속도를 부각시키기위해 사용자 1회 호출시 내부호출 20회 반복 호출 후 리턴\
유저 호출 -> [(앱1 <--> 앱2) x 20]\
(1회 내부호출속도는 /20, 총 호출횟수는 *20 추정)

## 테스트 시나리오
부하발생기: Apache JMeter 5.5\
가상사용자(Thread)를 10명씩 늘려가며 2분간 지속
> Number of Threads: 10 ~ 서버에러 발생시 까지\
> Ramp-up period: 120 sec\
> Loop Count: Infinite\
> Duration: 130 sec

## 테스트 환경
Kubernetes(RedHat Openshift)\
테스트 앱 복제수: 4 Pods\
\
/etc/hosts 수정\
1-node 테스트시
> {local_ip} test1-service test2-service

2-node 테스트시
> {node1_ip} test1-service\
> {node2_ip} test2-service

## 테스트 결과
| Users | Executions | | 90% 평균 ms | |
|-------|-------:|--------:|----:|----:|
|Threads| Rest   | gRPC    |Rest |gRPC |
|    10 | 36,385 |  29,584 |  32 |  31 |
|    20 | 61,445 |  52,873 |  61 |  24 |
|    30 | 39,108 |  97,149 |  80 |  33 |
|    40 | 35,343 | 100,707 | 162 |  38 |
|    50 | 79,400 | 119,916 | 116 |  50 |
|    60 | 79,619 | 126,343 | 122 |  52 |
|    70 | 75,226 | 142,423 | 173 |  53 |
|    80 | 85,080 | 122,011 | 208 |  84 |
|    90 | 88,214 | 151,150 | 207 |  64 |
|   100 | 91,416 | 148,903 | 244 |  72 |
|   110 | 98,680 | 178,640 | 228 |  78 |
|   120 | Error  | 178,502 |     |  82 |
|   130 |        | 168,636 |     | 100 |
|   140 |        | 186,747 |     |  95 |
|   150 |        | 172,288 |     | 106 |
|   160 |        | 176,109 |     | 105 |
|   170 |        | 244,077 |     |  88 |
|   180 |        | 197,923 |     | 117 |
|   190 |        | 257,438 |     |  94 |
|   200 |        | 250,842 |     | 105 |
|   210 |        | 258,934 |     | 109 |
|   220 |        | 263,203 |     | 109 |
|   230 |        | 267,270 |     | 120 |
|   240 |        | 265,969 |     | 112 |
|   250 |        | 259,201 |     | 119 |
|   260 |        | 249,763 |     | 140 |
|   270 |        | Error   |     |     |
